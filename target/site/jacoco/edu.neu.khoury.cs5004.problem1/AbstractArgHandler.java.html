<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>AbstractArgHandler.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">CS5004 Assignment</a> &gt; <a href="index.source.html" class="el_package">edu.neu.khoury.cs5004.problem1</a> &gt; <span class="el_source">AbstractArgHandler.java</span></div><h1>AbstractArgHandler.java</h1><pre class="source lang-java linenums">package edu.neu.khoury.cs5004.problem1;

import java.io.File;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

/**
 * An Abstract ArgHandler class.
 */
<span class="nc" id="L11">public abstract class AbstractArgHandler {</span>

  private static final String EMAIL_ERROR_STRING = &quot;Error: --email provided but no &quot;
      + &quot;--email-template was given.\n&quot;;

  private static final String LETTER_ERROR_STRING = &quot;Error: --letter provided but no &quot;
      + &quot;--email-template was given.\n&quot;;

<span class="fc" id="L19">  private static final Integer NUM_ARGS = 7;</span>

  private static final String EMAIL = &quot;--email&quot;;

  private static final String EMAIL_TEMPLATE = &quot;--email-template&quot;;

  private static final String LETTER = &quot;--letter&quot;;

  private static final String LETTER_TEMPLATE = &quot;--letter-template&quot;;

  private static final String OUTPUT = &quot;--output-dir&quot;;

  private static final String CSV = &quot;--csv-file&quot;;

  private static final String BAD_DIR = &quot;Directory does not exist.&quot;;


  /**
   * Given a string array from the cli, validates that the arguments are correct, stops program and
   * instructs user as to proper use of program.
   *
   * @param args command line interface arguments.
   */
  public static void validate(String[] args) throws IncorrectArgumentFormat {

<span class="fc" id="L44">    List&lt;String&gt; argList = new ArrayList&lt;&gt;(Arrays.asList(args));</span>
<span class="pc bpc" id="L45" title="1 of 2 branches missed.">    if (argList.size() != NUM_ARGS) {</span>
<span class="nc" id="L46">      throw new IncorrectArgumentFormat(AbstractArgHandler.instructions());</span>
    }

<span class="pc bpc" id="L49" title="1 of 4 branches missed.">    if (!argList.contains(EMAIL) &amp;&amp; !argList.contains(LETTER)) {</span>
<span class="nc" id="L50">      throw new IncorrectArgumentFormat(AbstractArgHandler.instructions());</span>
    }

<span class="fc bfc" id="L53" title="All 2 branches covered.">    if (!AbstractArgHandler.noEmailMismatch(argList)) {</span>
<span class="fc" id="L54">      throw new IncorrectArgumentFormat(EMAIL_ERROR_STRING</span>
          +
<span class="fc" id="L56">          AbstractArgHandler.instructions());</span>
    }

<span class="fc bfc" id="L59" title="All 2 branches covered.">    if (!AbstractArgHandler.noLetterMismatch(argList)) {</span>
<span class="fc" id="L60">      throw new IncorrectArgumentFormat(LETTER_ERROR_STRING</span>
          +
<span class="fc" id="L62">          AbstractArgHandler.instructions());</span>

    }

<span class="fc bfc" id="L66" title="All 2 branches covered.">    if (!AbstractArgHandler.hasCsv(argList)) {</span>
<span class="fc" id="L67">      throw new IncorrectArgumentFormat(AbstractArgHandler.instructions());</span>
    }

<span class="pc bpc" id="L70" title="1 of 2 branches missed.">    if (!AbstractArgHandler.hasOutput(argList)) {</span>
<span class="nc" id="L71">      throw new IncorrectArgumentFormat(AbstractArgHandler.instructions());</span>
    }

<span class="pc bpc" id="L74" title="1 of 2 branches missed.">    if (!AbstractArgHandler.hasTxt(argList)) {</span>
<span class="nc" id="L75">      throw new IncorrectArgumentFormat(AbstractArgHandler.instructions());</span>
    }

<span class="pc bpc" id="L78" title="1 of 2 branches missed.">    if (!AbstractArgHandler.isDirectory(argList)) {</span>
<span class="fc" id="L79">      throw new IncorrectArgumentFormat(BAD_DIR + AbstractArgHandler.instructions());</span>
    }

<span class="nc" id="L82">  }</span>

  /**
   * Reads strings and returns a Hub object with strings placed in appropriate fields.
   *
   * @param args args
   * @return hub Hub
   */
  public static Hub read(String[] args) {
<span class="fc" id="L91">    List&lt;String&gt; argList = new ArrayList&lt;&gt;(Arrays.asList(args));</span>
<span class="fc" id="L92">    String outputDir = &quot;&quot;;</span>
<span class="fc" id="L93">    String csv = &quot;&quot;;</span>
<span class="fc" id="L94">    String templateDir = &quot;&quot;;</span>
<span class="fc" id="L95">    String templateType = &quot;&quot;;</span>

<span class="fc bfc" id="L97" title="All 2 branches covered.">    for (String arg : args) {</span>
<span class="pc bpc" id="L98" title="4 of 18 branches missed.">      switch (arg) {</span>
        case OUTPUT:
<span class="fc" id="L100">          outputDir = (argList).get(argList.indexOf(arg) + 1);</span>
<span class="fc" id="L101">          break;</span>

        case EMAIL_TEMPLATE:
<span class="fc" id="L104">          templateDir = (argList).get(argList.indexOf(arg) + 1);</span>
<span class="fc" id="L105">          templateType = EMAIL_TEMPLATE;</span>
<span class="fc" id="L106">          break;</span>
        case LETTER_TEMPLATE:
<span class="fc" id="L108">          templateDir = (argList).get(argList.indexOf(arg) + 1);</span>
<span class="fc" id="L109">          templateType = LETTER_TEMPLATE;</span>
<span class="fc" id="L110">          break;</span>
        case CSV:
<span class="fc" id="L112">          csv = (argList).get(argList.indexOf(arg) + 1);</span>
<span class="fc" id="L113">          break;</span>
        default:
          break;
      }
    }

<span class="fc" id="L119">    return new Hub(templateDir, outputDir, csv, templateType);</span>
  }


  /**
   * Ascertains whether csv file exists.
   *
   * @param argList List of Strings
   * @return true or false
   */
  private static Boolean hasCsv(List&lt;String&gt; argList) {
<span class="pc bpc" id="L130" title="1 of 2 branches missed.">    for (String arg : argList) {</span>
<span class="fc bfc" id="L131" title="All 2 branches covered.">      if (arg.equals(CSV)) {</span>
<span class="fc" id="L132">        return (argList).get(argList.indexOf(arg) + 1).matches(&quot;.+(\\.csv)&quot;);</span>
      }
<span class="fc" id="L134">    }</span>
<span class="nc" id="L135">    return false;</span>
  }

  private static Boolean hasTxt(List&lt;String&gt; argList) {
<span class="pc bpc" id="L139" title="1 of 2 branches missed.">    for (String arg : argList) {</span>
<span class="fc bfc" id="L140" title="All 4 branches covered.">      if (arg.equals(EMAIL_TEMPLATE) || arg.equals(LETTER_TEMPLATE)) {</span>
<span class="fc" id="L141">        return (argList).get(argList.indexOf(arg) + 1).matches(&quot;.+(\\.txt)&quot;);</span>
      }
<span class="fc" id="L143">    }</span>
<span class="nc" id="L144">    return false;</span>
  }

  private static Boolean hasOutput(List&lt;String&gt; argList) {
<span class="pc bpc" id="L148" title="1 of 2 branches missed.">    for (String arg : argList) {</span>
<span class="fc bfc" id="L149" title="All 2 branches covered.">      if (arg.equals(OUTPUT)) {</span>
<span class="fc" id="L150">        return (argList).get(argList.indexOf(arg) + 1).matches(&quot;.+&quot;);</span>
      }
<span class="fc" id="L152">    }</span>
<span class="nc" id="L153">    return false;</span>
  }


  private static Boolean noEmailMismatch(List&lt;String&gt; argList) {
<span class="fc bfc" id="L158" title="All 2 branches covered.">    if (argList.contains(EMAIL)) {</span>
<span class="pc bpc" id="L159" title="1 of 4 branches missed.">      return !argList.contains(LETTER_TEMPLATE) &amp;&amp; argList.contains(EMAIL_TEMPLATE);</span>
    }

<span class="fc" id="L162">    return true;</span>

  }


  /**
   * Given an argList ests for letter mismatch.
   *
   * @param argList arglist
   * @return Boolean true or false
   */
  private static Boolean noLetterMismatch(List&lt;String&gt; argList) {
<span class="fc bfc" id="L174" title="All 2 branches covered.">    if (argList.contains(LETTER)) {</span>
<span class="pc bpc" id="L175" title="1 of 4 branches missed.">      return !argList.contains(EMAIL_TEMPLATE) &amp;&amp; argList.contains(LETTER_TEMPLATE);</span>
    }
<span class="fc" id="L177">    return true;</span>
  }


  /**
   * Tests whether output directory is legitimate.
   *
   * @param argList List of strings
   * @return Boolean true or false
   */
  private static Boolean isDirectory(List&lt;String&gt; argList) {
<span class="fc" id="L188">    String output = &quot;&quot;;</span>
<span class="fc bfc" id="L189" title="All 2 branches covered.">    for (String arg : argList) {</span>
<span class="fc bfc" id="L190" title="All 2 branches covered.">      if (arg.equals(OUTPUT)) {</span>
<span class="fc" id="L191">        output = (argList).get(argList.indexOf(arg) + 1);</span>
      }
<span class="fc" id="L193">    }</span>
<span class="fc" id="L194">    File file = new File(output);</span>
<span class="fc" id="L195">    return file.isDirectory();</span>
  }


  /**
   * Returns the instructions on how to use the program.
   *
   * @return String instructions.
   */
  private static String instructions() {
<span class="fc" id="L205">    return &quot;Usage:\n&quot;</span>
        + &quot; --email only generate email messages\n&quot;
        + &quot; --email-template &lt;file&gt; accept a filename that holds the\n&quot;
        + &quot;email template.\n&quot;
        + &quot; Required if --email is used\n&quot;
        + &quot; --letter only generate letters\n&quot;
        + &quot; --letter-template &lt;file&gt; accept a filename that holds\n&quot;
        + &quot;the email template.\n&quot;
        + &quot; Required if --letter is used\n&quot;
        + &quot; --output-dir &lt;path&gt; accept the name of a folder, all\n&quot;
        + &quot;output is placed in this folder\n&quot;
        + &quot; --csv-file &lt;path&gt; accept the name of the csv file to\n&quot;
        + &quot;process\n&quot;
        + &quot;Examples:\n&quot;
        + &quot; --email --email-template email-template.txt --output-dir\n&quot;
        + &quot;emails --csv-file customer.csv\n&quot;
        + &quot; --letter --letter-template letter-template.txt --outputdir\n&quot;
        + &quot;letters --csv-file customer.csv&quot;;
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>